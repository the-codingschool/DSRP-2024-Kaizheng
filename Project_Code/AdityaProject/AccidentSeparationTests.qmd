```{r}
traffic_data <- read.csv("Project_Code/Data/data_traffic.csv")


traffic_data <- select(traffic_data, c(time_cat, accident_year, month, day_of_week, primary_rd, secondary_rd, distance, weather_1, collision_severity, type_of_collision, mviw, ped_action, road_surface, road_cond_1, lighting, intersection, vz_pcf_description, number_killed, number_injured, dph_col_grp_description, party_number_ckey, party_type, at_fault, party_sex, party_age, party_sobriety, party_safety_equip_1, party_safety_equip_2, party_number_killed, party_number_injured, move_pre_acc, vehicle_year, stwd_vehicle_type, race))

traffic_data <- filter(traffic_data, at_fault == "Yes")


count(traffic_data, party_type)


DriverAccidents <- traffic_data |>
  filter(at_fault == "Yes") |>
  filter(party_type == "Driver")

DriverAccidents



count(DriverAccidents, party_type)



con_tab <- table(DriverAccidents$party_sex, DriverAccidents$at_fault)
con_tab

chi_tab <- chisq.test(con_tab)
chi_tab


```

